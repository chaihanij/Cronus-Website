<section id="contact-info" class="container">
    <div class="center" style="padding-bottom:10px">                
        <h2>Download the <%= @product.name %> product</h2>
    </div>
    <div class="row">
        <div class="col-md-12">
            <h2 id="transitions">Packages<small></small></h2>
            <p>&nbsp;&nbsp;&nbsp;&nbsp;<b><%= @product.name %></b>'s most current release is product 
            <code>
                <% if (@product.lastest_package_release != nil ) %>
                    <%= link_to  @product.lastest_package_release.version, [@product.lastest_package_release.product, @product.lastest_package_release] %>
                <% end %>
            </code>

            </p>
            <% if (@product.lastest_package_release != nil ) %>
            <p>
                <a href="<%= @lastest_package_release.package %>" class="btn btn-primary" >Get the latest!</a>
                <% if @lastest_package_release.release_package %>
                       <span class="label label-success">Release</span>&nbsp;
                <% end %>
                <% if @lastest_package_release.emergency_package %>
                    <span class="label label-warning">Emergency</span>&nbsp;
                <% end %>
                <I>Size&nbsp;(<b><%= @lastest_package_release.package_file_size %></b>)</I>,&nbsp;
                <I>Checksum&nbsp;(<b><%= @lastest_package_release.checksum %></b>)</I>
            </p>
            <i>Release Dates <a><%= @lastest_package_release.release_date.to_formatted_s(:rfc822) %></a> </i>
            
            <% if (@lastest_package_release.release_note_file_name != nil) then %>
                <h5>Release Notes for 
                    <a href="<%= @product.lastest_package_release.release_note %>"><%= @lastest_package_release.name %></a>
                </h5>
            <% end %>
            <% end %>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <h4 class="page-header">Latest <%= @product.name %> Release</h4>
            <div class="panel panel-default">
                <div class="table-responsive">
                    <table id="prodcut_show" class="table table-hover">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>OS</th>
                                <th>Release Dates</th>
                                <th>Size</th>
                                <th>Status</th>
                                <% if can? :manage, @package_in_product %>
                                    <th>Public</th>
                                    <th colspan="3"> </th>
                                <% end %>
                            </tr>
                        </thead>
                        <tbody>
                            <% @package_in_product.each do |package| %>
                            <tr>
                                <td>
                                    <%= link_to package.name, [package.product, package] %> 
                                </td>
                                <td>
                                    <% if (package.operating_system != nil) then %>
                                        <%= package.operating_system.name %>&nbsp;&nbsp;&nbsp;<%= package.operating_system.version %>
                                    <% else %>
                                       Othen operating system
                                    <% end %>
                                </td>
                                <td>
                                    <% if (package.release_date != nil) %>
                                        <b><%= package.release_date.to_formatted_s(:rfc822)  %></b>
                                    <% end %>
                                </td>
                                <td><%= package.package_file_size  %></td>
                                <td>
                                    <% if  package.release_package %>
                                        <span class="label label-success">Release</span>&nbsp;
                                    <% end %>    
                                    <% if package.emergency_package %>
                                        &nbsp;<span class="label label-warning">Emergency </span>&nbsp;
                                    <% end %>
                                    <% if package.notwork_package %>
                                        &nbsp;<span class="label label-danger">Broken</span>&nbsp;
                                    <% end %>
                                </td>
                                <% if can? :manage, [package.product, package] %>
                                <td>
                                    <% if package.is_public then %>
                                      <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                                    <% else %>
                                      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    <% end %>
                                </td>
                                <td>
                                    <%= link_to [package.product, package], method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-danger btn-xs" do %>
                                        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Delete
                                    <% end %>
                                </td>
                                <td>
                                    <%= link_to edit_product_package_path(package.product, package), class: "btn btn-warning btn-xs" do %>
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Edit
                                    <% end %>
                                </td>
                                <% end %>
                                <td>
                                    <%= link_to [package.product, package], class: "btn btn-success btn-xs"  do %>
                                        <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span> View
                                    <% end %>
                                </td>
                            </tr>
                            <% end %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>


<section id="contact-info" class="container">
    <div class="center" style="padding-bottom:10px">                
        <h2><code><%= @product.name %> Download</code></h2>
    </div>
    <div class="row">
        <div class="col-md-6 col-lg-6">
            <h2>Latest <%= @product.name %> Release</h2>
            <p><%= @product.name %> most current release is <code><%= link_to @product.versions.is_public.latest_version.name, product_version_download_path(@product, @product.versions.is_public.latest_version) %></code></p>
            <h3>Latest packages in version <%= link_to @lasted_version.name, product_version_download_path(@product, @product.versions.is_public.latest_version) %></h3>
            <div class="accordion">
                <div class="panel-group" id="accordion1">
                    <% @latest_package_files.each do |package_file| %>
                    <div class="panel panel-danger">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion1" href="#collapseOne<%=package_file.id%>">
                                    <%= package_file.package_file_name %>
                                <i class="fa fa-angle-right pull-right"></i>
                                </a>
                            </h3>
                        </div>
                        <div id="collapseOne<%=package_file.id%>" class="panel-collapse collapse">
                           <div class="panel-body">
                                <div class="media accordion-inner">
                                    <div class="media-body">
                                    <dl class="dl-horizontal">
                                        <dt>
                                            Name
                                        </dt>
                                        <dd>
                                            <%= link_to package_file.package_file_name,  [package_file.version.product, package_file.version ,package_file] %>
                                        </dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>OS</dt>
                                        <dd><%= package_file.operating_system.name %>&nbsp;&nbsp;&nbsp;<%= package_file.operating_system.version %></dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>Build date</dt>
                                        <dd><%= package_file.build_date %></dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>Release date</dt>
                                        <dd><%= package_file.release_date %></dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>Checksum</dt>
                                        <dd><%= package_file.checksum %></dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>Size</dt>
                                        <dd><%= package_file.package_file_size %></dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt></dt>
                                        <dd>
                                            <%= link_to "Download " + package_file.package_file_name, package_file.package.url, class:"btn btn-primary" %>
                                        </dd>
                                    </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% end %>
                </div>
            </div>
            <h5>Release Notes for <%= link_to @lasted_version.name, @lasted_version.release_note.url() %></h5>
        </div>
        <div class="col-md-6 col-lg-6"></div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <h4 class="page-header">Latest version</h4>
             <div class="accordion">
                <div class="panel-group" id="accordion2">
                    <% @list_version.each do |version| %>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo<%=version.id%>">
                                    <%= version.name %>
                                <i class="fa fa-angle-right pull-right"></i>
                                <% if  version.release_version %>
                                      <span class="label label-success pull-right">Release</span>&nbsp;
                                    <% end %>
                                    <% if version.emergency_version %>
                                      <span class="label label-warning pull-right">Emergency</span>&nbsp;
                                    <% end %>
                                    <% if version.broken_version %>
                                        <span class="label label-danger pull-right">Broken</span>&nbsp;
                                    <% end %>
                                </a>
                            </h3>
                        </div>
                        <div id="collapseTwo<%=version.id%>" class="panel-collapse collapse">
                           <div class="panel-body">
                                <div class="media accordion-inner">
                                    <div class="media-body">
                                        <div class="form-horizontal">
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label"><b>Version</b></label>
                                                <div class="col-sm-8">
                                                    <label class="control-label">
                                                        <%= link_to version.name , product_version_download_path(@product, version) %>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label"><b>Release note</b></label>
                                                <div class="col-sm-8">
                                                    <label class="control-label">
                                                        <%= link_to version.release_note_file_name, version.release_note.url() %>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label"><b>Packges</b></label>
                                                <div class="col-sm-8">                                    
                                                    <% version.package_files.is_public.each_with_index do |package_file, index| %>
                                                    <div class="jumbotron" style="padding-left: 20px;padding-right: 20px;padding-top: 20px;padding-bottom: 20px;">
                                                        <dl class="dl-horizontal">
                                                            <dt>
                                                                Name
                                                            </dt>
                                                            <dd>
                                                                <%= link_to package_file.package_file_name,  [package_file.version.product, package_file.version ,package_file] %>
                                                            </dd>
                                                        </dl>
                                                        <dl class="dl-horizontal">
                                                            <dt>OS</dt>
                                                            <dd><%= package_file.operating_system.name %>&nbsp;&nbsp;&nbsp;<%= package_file.operating_system.version %></dd>
                                                        </dl>
                                                        <dl class="dl-horizontal">
                                                            <dt>Build date</dt>
                                                            <dd><%= package_file.build_date %></dd>
                                                        </dl>
                                                        <dl class="dl-horizontal">
                                                            <dt>Release date</dt>
                                                            <dd><%= package_file.release_date %></dd>
                                                        </dl>
                                                        <dl class="dl-horizontal">
                                                            <dt>Checksum</dt>
                                                            <dd><%= package_file.checksum %></dd>
                                                        </dl>
                                                        <dl class="dl-horizontal">
                                                            <dt>Size</dt>
                                                            <dd><%= package_file.package_file_size %></dd>
                                                        </dl>
                                                        <dl class="dl-horizontal">
                                                            <dt></dt>
                                                            <dd>
                                                                <%= link_to "Download " + package_file.package_file_name, package_file.package.url, class:"btn btn-primary" %>
                                                            </dd>
                                                        </dl>
                                                        
                                                    </div>
                                                    <% end %>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% end %>
                </div>
            </div>
        </div>
    </div>
</section>